<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debt Payoff Goal Thermometer</title>
  <style>
    html {
      /*background: -webkit-radial-gradient(circle, #fcee92 0%,#ebcf12 100%);*/
      height: 100%;
      width: 100%;
    }
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .header {
      text-align: center;
      margin: 32px 0 24px;
    }
    .title {
      font-size: 2em;
      font-weight: bold;
      color: #4a1c03;
      margin-bottom: 10px;
      letter-spacing: 2px;
    }
    .website {
      color: #7f8c8d;
      font-size: 1.2em;
    }
    .input-section {
      background: #fff7db;
      padding: 16px 24px;
      border-radius: 10px;
      margin-bottom: 30px;
      box-shadow: 0 2px 8px rgba(90,60,8,0.1);
      text-align: center;
      width: 500px;
    }
    .input-group { margin-bottom: 14px; }
    .input-group label {
      font-size: 1em;
      font-weight: bold;
      color: #4a1c03;
      margin-bottom: 7px;
      display: block;
    }
    .input-group input {
      font-size: 1em;
      padding: 7px 10px;
      border: 2px solid #eee08e;
      border-radius: 5px;
      width: 90%;
      text-align: center;
      margin-bottom: 7px;
    }
    .input-group select {
      font-size: 1em;
      padding: 7px 10px;
      border: 2px solid #eee08e;
      border-radius: 5px;
      width: 100%;
      text-align: center;
      margin-bottom: 7px;
    }
    .thermometer-wrap {
      position: relative;
      min-height: 775px;
      display: flex;
      justify-content: center;
    }

    /* Your Thermometer CSS */
    .thermometer{
      margin:50% 0 0 50%;
      left:-100px;
      top:-100px;
      width:100px;
      height:700px;
      display:block;
      font:bold 14px/152px helvetica, arial, sans-serif;
      text-indent: 36px;
      background: -webkit-linear-gradient(top, #fff 0%, #fff 50%, #fff 50%, #fff 100%);
      border-radius:100px 100px 0 0;
      border:5px solid #4a1c03;
      border-bottom:none;
      position:absolute;
      box-shadow:inset 0 0 0 4px #fff;
      color:#4a1c03;
      background-image:linear-gradient(to right, #fff, transparent 1px), linear-gradient(#ccc, transparent 1px);
      background-size: 40px 40px;
    }
    .thermometer:before{
      content:' ';
      width:121px;
      height:121px;
      display:block;
      position:absolute;
      top:670px;
      left:-16px;
      z-index:1;
      /*background:#db3f02;*/
      border-radius:50%;
      border:5px solid #4a1c03;
      background: #fff;
    }

    /* Progress filler overlay (dynamically sized) */
    .progress-bar {
      position: absolute;
      left:0;
      bottom:0;
      width: 22px;
      /* slightly less than the thermometer height */
      border-radius: 22px 22px 0 0;
      background: #db3f02;
      z-index: 1;
      box-shadow:inset 0 0 0 2px #fff, 0 1px 2px rgba(70,30,0,0.1);
      transition: height 0.4s cubic-bezier(.35,1.3,.63,1);
      /* Parent is positioned absolute */
    }
    .scale {
      position: absolute;
      left: 110px;
      right: 10;
      top: 0;
      height: 600px;
      width: 100px;
    }
    .scale-item {
      position: absolute;
      left: 0;
      display: flex;
      align-items: center;
      font-weight: bold;
      font-size: 16px;
      color: #4a1c03;
      height: 30px;
    }

    .percentage {
        color: #2c3e50;
        margin-right: 10px;
        min-width: 40px;
        text-align: right;
    }
    
    .amount {
        color: #27ae60;
        font-size: 16px;
        min-width: 75px;
        text-align: right;
    }

    .interest {
        color: red;
        font-size: 16px;
        min-width: 75px;
        text-align: right;
    }
    .scale-tick {
      width: 15px;
      height: 3px;
      background: #4a1c03;
      margin: 0 7px;
    }
    .current-amount {
      text-align: center;
      margin-top: 35px;
      font-size: 1.2em;
      color: #4a1c03;
      background: #fff9e0;
      display:inline-block;
      padding:8px 14px;
      border-radius: 7px;
      border:1px solid #ecd959;
      box-shadow: 0 2px 6px rgba(120,100,20,0.04);
    }
    .debt-free {
      text-align: center;
      font-size: 1.4em;
      font-weight: bold;
      color: #27ae60;
      margin-top: 18px;
      animation: pulse 2s infinite;
    }
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.7; }
      100% { opacity: 1; }
    }

    @media print {
        .noprint {
            visibility: hidden;
            display: none !important;
        }
    }

  </style>
</head>
<body>

  <div class="header">
    <div class="title" id="debtName">DEBT PAYOFF GOAL</div>
  </div>

  <div class="input-section noprint">
    <div class="input-group">
      <label for="totalDebt">Enter Total Amount to Payoff:</label>
      <input type="number" id="totalDebt" value="100000" min="1">
    </div>
    <div class="input-group">
      <label for="currentDebt">Enter Current Debt Amount:</label>
      <input type="number" id="currentDebt" value="100000" min="0">
    </div>
    <div class="input-group">
      <label for="interestRate">Enter Interest rate:</label>
      <input type="number" id="interestRate" value="10" min="0">
    </div>
    <div class="input-group">
      <label for="debtNameInput">Enter Name of the debt:</label>
      <input type="text" id="debtNameInput" value="DEBT PAYOFF GOAL">
    </div>
    <div class="input-group">
      <label for="debtSelector">Load a saved debt:</label>
      <select id="debtSelector" onchange="onSelect()">
      </select>
    </div>
    <button onclick="updateThermometer()" style="padding: 7px 18px; font-size: 1em; background:#db3f02; color: white; border: none; border-radius: 5px; cursor: pointer;">Update Thermometer</button>
    <button onclick="deleteThermometer()" style="padding: 7px 18px; font-size: 1em; background:#db3f02; color: white; border: none; border-radius: 5px; cursor: pointer;">Delete Thermometer</button>
  </div>

  <div class="thermometer-wrap" style="width:180px; height:220px; position: relative;">
    <div class="thermometer" id="thermometer">
      <div class="progress-bar" id="progressBar"></div>
    </div>
    <div class="scale" id="scale"></div>
  </div>

  <div class="current-amount noprint" id="currentAmount">
    Remaining: $100,000 (0% Complete)
  </div>

  <div class="debt-free noprint" id="debtFree" style="display: none;">
    Debt Free!!!!
  </div>

  <script>
    const totalDebtElement = document.getElementById('totalDebt');
    const currentDebtElement = document.getElementById('currentDebt');
    const interestRateElement = document.getElementById('interestRate');
    const debtNameInputElement = document.getElementById('debtNameInput');
    const debtSelectorElement = document.getElementById('debtSelector');

    let debts = [];


    const updateSelector = (selected) => {
      debts = Object.keys(localStorage).filter((key) => key !== 'currentDebt');
      const newIndex = debts.indexOf(selected);
      debtSelectorElement.length = 0;
      for (const debt of debts) {
        const newOption = document.createElement("option");
        newOption.value = debt;
        newOption.textContent = debt;
        debtSelectorElement.appendChild(newOption);
      }
      if (newIndex > 0) {
        debtSelectorElement.selectedIndex = newIndex;
      } else {
        debtSelectorElement.selectedIndex = 0;
      }
    }

    const onSelect = () => {
      const selected = debtSelectorElement.value;
      loadSetup(selected);
    }


    const saveSetup = () => {
      const debtName = debtNameInput.value;
      localStorage.setItem('currentDebt', debtName);
      localStorage.setItem(debtName, JSON.stringify({
        debtName,
        totalDebt: totalDebtElement.value,
        currentDebt: currentDebtElement.value,
        interestRate: interestRateElement.value,
      }));
    }

    const loadSetup = (name) => {
      const stored = localStorage.getItem(name)
      if (!stored) {
        alert(`No saved debts by name ${name}`);
        return;
      }
      const parsed = JSON.parse(stored);

      totalDebtElement.value = parsed.totalDebt;
      currentDebtElement.value = parsed.currentDebt;
      interestRateElement.value = parsed.interestRate;
      debtNameInputElement.value = parsed.debtName;
      updateSelector(name);
      updateThermometer();
    }


    const updateThermometer = () => {
      const totalDebt = parseFloat(totalDebtElement.value) || 0;
      let currentDebt = parseFloat(currentDebtElement.value) || 0;
      const interestRate = parseFloat(interestRateElement.value) || 0;
      const debtNameInput = debtNameInputElement.value || 'DEBT PAYOFF GOAL';
      document.getElementById('debtName').innerHTML  = debtNameInput;
      saveSetup();
      updateSelector(debtNameInput);

      
      if (totalDebt <= 0) {
        alert('Please enter a valid total debt amount');
        return;
      }
      
      if (currentDebt < 0 || currentDebt > totalDebt) {
        currentDebt = totalDebt;
        document.getElementById('currentDebt').value = currentDebt
      }
      
      const paid = totalDebt - currentDebt;
      const percentPaid = (paid / totalDebt) * 100;
      // Display text
      const currentAmount = document.getElementById('currentAmount');
      currentAmount.textContent = `Remaining: $${currentDebt.toLocaleString()} (${percentPaid.toFixed(1)}% Complete)`;
      // Debt-free message
      const debtFree = document.getElementById('debtFree');
      
      if (percentPaid >= 100) {
        debtFree.style.display = 'block';
        currentAmount.textContent = 'Congratulations! You are debt free! ðŸŽ‰';
      } else {
        debtFree.style.display = 'none';
      }
      
      // Update scale
      const scale = document.getElementById('scale');
      scale.innerHTML = '';
      
      // Place a tick every 10%
      for (let i = 0; i <= 100; i += 5) {
        const scaleItem = document.createElement('div');
        scaleItem.className = 'scale-item';
        scaleItem.style.top = `${690 - (i * 6.75) - 12}px`; // align tick to bar


        const remaining = totalDebt * (1 - i / 100);
        const monthlyInterest = remaining * ( interestRate / 12 / 100 );

        const innerHTML = [
            `<div class="percentage">${i}%</div>`,
            '<div class="scale-tick"></div>',
            `<div class="amount">$${remaining.toFixed(2)}</div>`,
        ]

        innerHTML.push(
            `<div class="interest">$${monthlyInterest.toFixed(2)}</div>`
        );
        
        scaleItem.innerHTML = innerHTML.join('\n');
        scale.appendChild(scaleItem);
      }
    }

    const deleteThermometer = () => {
      const debtName = debtSelectorElement.value
      console.log(debtName);
      localStorage.removeItem(debtName);
      debts = debts.filter((name) => name !== debtName);
      loadSetup(debts[0]);
    }

    // Init
    window.onload = updateThermometer;
    // Enter in inputs
    document.getElementById('totalDebt').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') updateThermometer();
    });
    document.getElementById('currentDebt').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') updateThermometer();
    });

    if (localStorage.getItem('currentDebt')) {
      loadSetup(localStorage.getItem('currentDebt'));
    }
  </script>
</body>
</html>
